function t_form__conditionals_initFields(t,e){return t_form__conditionals_syncFields(t,{shouldPreventSubmit:!1,ignoredInputGroups:e}),t_form__conditionals_initFieldsListeners(t,e),t_form__conditionals_notifyAboutInit(t),{addListeners:function n(r){t_form__conditionals_addFieldsListeners(t,r,e)}}}function t_form__conditionals_syncFields(t,e){e=e||{shouldPreventSubmit:!0,ignoredInputGroups:[]};var n=document.getElementById("rec"+t),r=n.querySelectorAll(".t-conditional[data-conditionals]");0===r.length&&(r=n.querySelectorAll(".t-input-group[data-conditionals]"));var o=Array.prototype.slice.call(r);e.ignoredInputGroups&&e.ignoredInputGroups.length&&(o=t_form__conditionals_filterOut(o,e.ignoredInputGroups)),o.forEach((function(n){var r=n.getAttribute("data-conditionals"),o=JSON.parse(r),i=o.action,a=o.conditions,c=o.conditionsCombination,u=a.map((function(e){return t_form__conditionals_calculateCondition(t,e)})).filter((function(t){return"invalid"!==t.status}));if(0!==u.length){var l=u.some((function(t){return"hidden"===t.status}));if("all"!==c&&1!==u.length||!l){var s="all"===c?u.every(t_form__conditionals_canApplyCondition):u.some(t_form__conditionals_canApplyCondition),_;if(e.shouldPreventSubmit)t_form__conditionals_shouldPreventSubmit(n,s,i)&&t_form__conditionals_preventSubmit(n);return"hide"===i?s?t_form__hideField(n):t_form__showField(n):"show"===i?s?t_form__showField(n):t_form__hideField(n):void 0}t_form__hideField(n)}}))}function t_form__conditionals_shouldPreventSubmit(t,e,n){var r=t.getAttribute("data-hidden-by-condition");return"hide"===n?e&&!r:"show"===n?e&&r:void 0}function t_form__conditionals_handlePreventSubmit(t){t.target.classList.contains("t-submit")&&(t.preventDefault(),t.stopPropagation()),this.removeEventListener("click",t_form__conditionals_handlePreventSubmit),this.removeEventListener("focusout",t_form__conditionals_handlePreventSubmit)}function t_form__conditionals_preventSubmit(t){var e=t.closest("form");e&&(e.addEventListener("click",t_form__conditionals_handlePreventSubmit,{once:!0}),e.addEventListener("focusout",t_form__conditionals_handlePreventSubmit,{once:!0}))}function t_form__conditionals_initFieldsListeners(t,e){function n(){t_form__conditionals_syncFields(t,{ignoredInputGroups:e})}t_form__conditionals_addFieldsListeners(t,n,e)}function t_form__conditionals_addFieldsListeners(t,e,n){var r,o=document.getElementById("rec"+t).querySelector(".t-form__inputsbox"),i=Array.prototype.slice.call(o.querySelectorAll(".t-input-group"));n&&n.length&&(i=t_form__conditionals_filterOut(i,n)),i.forEach((function(t){t_form__conditionals_getCallbacks(t).listen(e)}))}function t_form__conditionals_calculateCondition(t,e){var n=e.fieldId,r,o=document.getElementById("rec"+t).querySelector('.t-input-group[data-input-lid="'+n+'"]'),i=t_form__conditionals_isConditionEmpty(e),a=e.disabled;if(!o||i||a)return{status:"invalid",value:null};var c=o.closest(".t-conditional"),u;return"true"===o.getAttribute("data-hidden-by-condition")||c&&"true"===c.getAttribute("data-hidden-by-condition")?{status:"hidden",value:null}:{status:"valid",value:t_form__conditionals_getCallbacks(o).verify(e)}}function t_form__showField(t){t.ariaHidden=!1,t.removeAttribute("data-hidden-by-condition");var e=t.querySelector(".t-quiz__step__img-wrapper"),n="",r;if(t.classList.contains("t-quiz__step__input")){var o=t.querySelector(".t-input-group");n=o?o.getAttribute("data-field-type"):""}else n=t.getAttribute("data-field-type");("ri"===n||e)&&window.t_lazyload_update&&window.t_lazyload_update(),t.querySelectorAll('.js-tilda-rule[data-tilda-req="1"]').forEach((function(t){t.removeAttribute("data-hidden-by-condition")}))}function t_form__hideField(t){var e;t.ariaHidden=!0,t.setAttribute("data-hidden-by-condition","true"),t.querySelectorAll('.js-tilda-rule[data-tilda-req="1"]').forEach((function(t){t.setAttribute("data-hidden-by-condition","true")}))}function t_form__conditionals_getCallbacks(t){var e=t.getAttribute("data-field-type"),n=t.getAttribute("data-input-lid"),r={rd:{verify:function e(n){var r=n.condition;return t_form__conditionals_verifyCheckboxOrRadio(t,r)},listen:function e(n){var r,o;("cb"===t.getAttribute("data-field-radcb")?t.querySelectorAll('input[type="checkbox"]'):t.querySelectorAll('input[type="radio"]')).forEach((function(t){t.addEventListener("change",n)}))}},sb:{verify:function e(n){var r=n.fieldId,o=n.condition,i=t.querySelector("#input_"+r),a=i.value.trim(),c=i.options[i.selectedIndex],u;return c&&c.hasAttribute("data-calc-value")&&(a=t_form__conditionals_prepareCalcValue(c).trim()),a===o.value.trim()},listen:function e(n){var r;t.querySelector("select").addEventListener("change",n)}},ri:{verify:function e(n){var r=n.condition;return t_form__conditionals_verifyCheckboxOrRadio(t,r)},listen:function e(n){var r,o;("cb"===t.getAttribute("data-field-radcb")?t.querySelectorAll('input[type="checkbox"]'):t.querySelectorAll('input[type="radio"]')).forEach((function(t){t.addEventListener("change",n)}))}},qn:{verify:function e(n){var r=n.condition,o;return t_form__conditionals_compareNumbers(t.querySelector('input[type="number"]').value,r.value,r.comparisonType)},listen:function e(n){var r=t.querySelector('input[type="number"]'),o=t.querySelectorAll(".t-inputquantity__btn");t_form__conditionals_listenToEventOrEnterPress(r,"change",n),o.forEach((function(t){t&&t.addEventListener("click",n)}))}},rg:{verify:function e(n){var r=n.condition,o;return t_form__conditionals_compareNumbers(t.querySelector('input[type="range"]').value,r.value,r.comparisonType)},listen:function e(n){var r;t_form__conditionals_listenToEventOrEnterPress(t.querySelector('input[type="range"]'),"change",n)}},fr:{verify:function e(n){var r=n.condition,o;return t_form__conditionals_compareNumbers(t.querySelector("input.t-calc__hiddeninput").value,r.value,r.comparisonType)},listen:function e(n){var r=t.querySelector("input.t-calc__hiddeninput");r&&r.addEventListener("change",n)}},in:{verify:function e(n){var r=n.condition,o=t.querySelector('input[type="text"]'),i,a;return t_form__conditionals_compareStrings(t_form__conditionals_inputMatchesMask(o,["data-tilda-mask"])?o.value:"",r.value,r.comparisonType)},listen:function e(n){var r=t.querySelector('input[type="text"]');r&&(r.getAttribute("data-tilda-mask")?t_form__conditionals_listenToEventOrEnterPress(r,"blur",n):t_form__conditionals_listenToEventOrEnterPress(r,"change",n))}},ta:{verify:function e(n){var r=n.condition,o,i,a;return t_form__conditionals_compareStrings(t.querySelector("textarea").value.split("\n").map((function(t){return t.trim()})).filter(Boolean).join(" "),r.value,r.comparisonType)},listen:function e(n){var r=t.querySelector("textarea");r&&r.addEventListener("change",n)}},em:{verify:function e(n){var r=n.condition,o,i;return t_form__conditionals_compareStrings(t.querySelector('input[type="email"]').value,r.value,r.comparisonType)},listen:function e(n){var r;t_form__conditionals_listenToEventOrEnterPress(t.querySelector('input[type="email"]'),"change",n)}},ph:{verify:function e(n){var r=n.condition,o,i,a;return t_form__conditionals_compareStrings(t_form__conditionals_inputMatchesMask(t.querySelector('input[type="tel"]'),["data-phonemask-without-code","data-tilda-mask"])?t_form__conditionals_getCurrentPhone(t):"",r.value,r.comparisonType)},listen:function e(n){var r=t.querySelector('input[type="tel"]');if(r){var o=r.getAttribute("data-tilda-mask"),i;t_form__conditionals_listenToEventOrEnterPress(r,o?"blur":"change",n),t.querySelectorAll(".t-input-phonemask__options-item").forEach((function(t){t.addEventListener("click",n)}))}}},nm:{verify:function e(r){var o=r.condition,i,a;return t_form__conditionals_compareStrings(t.querySelector('input[type="text"]#input_'+n).value,o.value,o.comparisonType)},listen:function e(r){var o;t_form__conditionals_listenToEventOrEnterPress(t.querySelector('input[type="text"]#input_'+n),"change",r)}},ur:{verify:function e(r){var o=r.condition,i,a;return t_form__conditionals_compareStrings(t.querySelector('input[type="text"]#input_'+n).value,o.value,o.comparisonType)},listen:function e(r){var o;t_form__conditionals_listenToEventOrEnterPress(t.querySelector('input[type="text"]#input_'+n),"change",r)}},da:{verify:function e(r){var o=r.condition,i,a;return t_form__conditionals_compareDates(t_form__conditionals_prepareDateFromDatePicker(t.querySelector("#input_"+n)),o.value,o.comparisonType)},listen:function e(r){var o=t.querySelector("#input_"+n);o&&(t_form__conditionals_listenToEventOrEnterPress(o,"blur",r),o.addEventListener("change",(function(){r()})))}},tm:{verify:function e(r){var o=r.condition,i=t.querySelector("#input_"+n),a,c;return t_form__conditionals_compareTime(t_form__conditionals_inputMatchesMask(i,["data-tilda-mask"])?i.value:"",o.value,o.comparisonType)},listen:function e(r){var o=t.querySelector("#input_"+n);o&&t_form__conditionals_listenToEventOrEnterPress(o,"blur",r)}},cb:{verify:function e(n){var r=n.condition,o,i;return t_form__conditionals_compareCheckbox(t.querySelector('input[type="checkbox"]').checked,r.comparisonType)},listen:function e(n){var r=t.querySelector('input[type="checkbox"]');r&&r.addEventListener("change",n)}},uw:{verify:function e(n){var r=n.condition,o=t.querySelector(".t-upwidget-container__data"),i,a;return o?t_form__conditionals_compareFiles(o.querySelector('input[type="hidden"]'),r.comparisonType):"not_uploaded"===t_form__conditionals_prepareComparisonType(r.comparisonType).type},listen:function e(n){var r=document.querySelector(".t-records"),o;(r?r.getAttribute("data-tilda-mode"):null)||t_onFuncLoad("t_upwidget__init",(function(){setTimeout((function(){var e=t.querySelector(".t-upwidget-container");e&&(e.addEventListener("uwFileUploaded",n),e.addEventListener("uwFileRemoved",n))}),500)}))}},uc:{verify:function e(n){var r=n.condition,o;return t_form__conditionals_compareFiles(t.querySelector('input[role="uploadcare-uploader"]'),r.comparisonType)},listen:function t(e){var r=document.querySelector(".t-records"),o;(r?r.getAttribute("data-tilda-mode"):null)||t_onFuncLoad("uploadcare",(function(){var t=window.uploadcare,r;t&&t.Widget('[data-input-lid="'+n+'"] [role="uploadcare-uploader"]').onUploadComplete.add(e)}))}},rs:{verify:function e(n){var r=n.condition,o=t.querySelectorAll('input[type="radio"]'),i;return Array.from(o).filter((function(t){return t.checked})).some((function(t){return t_form__conditionals_compareNumbers(t.value,r.value,r.comparisonType)}))},listen:function e(n){var r;t.querySelectorAll('input[type="radio"]').forEach((function(t){t.addEventListener("change",n)}))}},dl:{verify:function e(n){var r=n.condition,o=t.querySelectorAll('input[type="radio"]'),i;return Array.from(o).filter((function(t){return t.checked})).some((function(t){return t.value===r.value}))},listen:function e(n){var r;t.querySelectorAll('input[type="radio"]').forEach((function(t){t.addEventListener("change",n)}))}}};return e in r?r[e]:{verify:function t(){},listen:function t(){}}}function t_form__conditionals_compareNumbers(t,e,n){var r=t_form__conditionals_prepareComparisonType(n),o=r.group,i=r.type;if(-1!==o.indexOf("btwn")&&!Array.isArray(e))return console.warn("Condition value must of type [number, number] when comparison type is range. Condition value is:"+e),!1;if(!e)return console.warn("Please, set the condition value, otherwise the condition wont work. Condition value is:"+e),!1;if(""===t)return!1;var a=Number(t),c=Array.isArray(e)?e.map(Number):Number(e);switch(i){case"equals":return a===c;case"not_equals":return a!==c;case"greater":return a>c;case"less":return a<c;case"greater_equal":return a>=c;case"less_equal":return a<=c;case"fits":return c[0]<a&&a<c[1];case"fits_include_start":return c[0]<=a&&a<c[1];case"fits_include_end":return c[0]<a&&a<=c[1];case"fits_include_both":return c[0]<=a&&a<=c[1];default:throw new Error("Unknown comparison type when comparing two numbers:"+n)}}function t_form__conditionals_compareStrings(t,e,n){var r,o=t_form__conditionals_prepareComparisonType(n).type,i=t.trim().toLowerCase(),a=e.trim().toLowerCase();switch(o){case"equals":return i===a;case"not_equals":return Boolean(i)&&i!==a;case"includes":return-1!==i.indexOf(a);case"excludes":return Boolean(i)&&-1===i.indexOf(a);case"filled_in":return Boolean(i);case"not_filled_in":return!i;default:throw new Error("Unknown comparison type when comparing two strings:"+n)}}function t_form__conditionals_compareDates(t,e,n){var r=t_form__conditionals_prepareComparisonType(n),o=r.group,i=r.type;if(-1!==o.indexOf("btwn")&&!Array.isArray(e))return console.warn("Condition value must of type [string, string] when comparison type is range. Condition value is: "+e),!1;function a(t){return t?new Date(t).getTime():NaN}var c=a(t),u=Array.isArray(e)?e.map(a):a(e);switch(i){case"equals":return c===u;case"not_equals":return Boolean(c)&&c!==u;case"greater":return c>u;case"less":return c<u;case"fits":return u[0]<c&&c<u[1];default:throw new Error("Unknown comparison type when comparing dates: "+n)}}function t_form__conditionals_prepareDateFromDatePicker(t){var e=t_form__conditionals_getDateDivider(t),n=t.value.split(e),r=t.getAttribute("data-tilda-dateformat");if(""!=n){if("DD-MM-YYYY"===r)return n[2]+"-"+n[1]+"-"+n[0];if("MM-DD-YYYY"===r)return n[2]+"-"+n[0]+"-"+n[1];if("YYYY-MM-DD"===r)return n[0]+"-"+n[1]+"-"+n[2]}}function t_form__conditionals_getDateDivider(t){if(t){var e=t.getAttribute("data-tilda-datediv");return"dash"!==e&&e?"slash"===e?"/":"dot"===e?".":void 0:"-"}}function t_form__conditionals_compareTime(t,e,n){var r=t_form__conditionals_prepareComparisonType(n),o=r.group,i=r.type;if(-1!==o.indexOf("btwn")&&!Array.isArray(e))return console.warn("Condition value must of type [string, string] when comparison type is range. Condition value is: "+e),!1;switch(i){case"equals":return t===e;case"not_equals":return Boolean(t)&&t!==e;case"greater":return Boolean(t)&&t>e;case"less":return Boolean(t)&&t<e;case"fits":return e[0]<t&&t<e[1];default:throw new Error("Unknown comparison type when comparing time: "+n)}}function t_form__conditionals_compareCheckbox(t,e){var n;switch(t_form__conditionals_prepareComparisonType(e).type){case"filled_in":return Boolean(t);case"not_filled_in":return!t;default:throw new Error("Unknown comparison type when comparing checkbox: "+e)}}function t_form__conditionals_getCurrentPhone(t){var e=t.querySelector('input[type="tel"]');if(!e)return"";var n=e.getAttribute("data-phonemask-code"),r=e.value||"";return n?n+" "+r:r}function t_form__conditionals_maskToRegex(t){var e={9:"[0-9]",a:"[A-Za-z]","а":"[А-Яа-яЁё]","*":"[A-Za-zА-Яа-яЁё0-9]"},n=t.replace(/([[\]{}()^$.+?|])/g,"\\$1");return new RegExp("^"+n.split("").map((function(t){return e[t]||t})).join("")+"$")}function t_form__conditionals_valueMathchesMask(t,e){return!!t&&t_form__conditionals_maskToRegex(e).test(t);var n}function t_form__conditionals_inputMatchesMask(t,e){if(!t)return!1;var n=e.filter((function(e){return t.hasAttribute(e)}));return 0===n.length||n.some((function(e){return t_form__conditionals_valueMathchesMask(t.value,t.getAttribute(e))}))}function t_form__conditionals_isConditionEmpty(t){var e=t.condition.value,n;return-1===t_form__conditionals_prepareComparisonType(t.condition.comparisonType).group.indexOf("st")&&!e}function t_form__conditionals_prepareComparisonType(t){var e=t.split("-"),n,r;return{group:e[0],type:e[1]}}function t_form__conditionals_compareFiles(t,e){var n=t_form__conditionals_prepareComparisonType(e).type;if("uploaded"===n)return Boolean(t&&t.value);if("not_uploaded"===n)return Boolean(!t||!t.value);throw new Error("Unknown comparison type when comparing files: "+e)}function t_form__conditionals_canApplyCondition(t){return"valid"===t.status&&Boolean(t.value)}function t_form__conditionals_filterOut(t,e){return t.filter((function(t){return!t.matches(e.join(","))}))}function t_form__conditionals_listenToEventOrEnterPress(t,e,n){if(t){var r=!1;t.addEventListener(e,(function(){r||n(),r=!1})),t.addEventListener("keydown",(function(t){"Enter"===t.key&&(n(),r=!0)}))}}function t_form__conditionals_prepareCalcValue(t){var e=t.value;if(!e)return e;var n=t.getAttribute("data-calc-value"),r=t.getAttribute("data-own-variant-title");return r?[r,n].join("="):[e,n].join("=")}function t_form__conditionals_verifyCheckboxOrRadio(t,e){var n,r="cb"===t.getAttribute("data-field-radcb")?t.querySelectorAll('input[type="checkbox"]'):t.querySelectorAll('input[type="radio"]'),o;return Array.from(r).filter((function(t){return t.checked})).some((function(t){var n=e.value.trim(),r,o,r;return t.hasAttribute("data-calc-value")?(r=t_form__conditionals_prepareCalcValue(t).trim())===n:(r=(r=e._meta&&"li_ownvariant"in e._meta?t.getAttribute("data-own-variant-title"):t.value)?r.trim():"")===n}))}function t_form__conditionals_notifyAboutInit(t){var e="conditional-form-init",n=document.getElementById("rec"+t),r=new CustomEvent(e);n.dispatchEvent(r)}function t_form__conditionals__initStepForm(t){var e=t.ignoredSteps||[],n=t.ignoredInputGroups||[],r=t.recId,o=t.onConditionalFieldChange,i=Array.prototype.slice.call(t.steps),a=t.activeStepIndex,c=i[a],u,l,s,_,d=t_form__conditionals_initFields(r,n);function f(){return{nextStepIndex:s,prevStepIndex:_,activePossibleStepIndex:l,totalActiveStepsCount:u.length}}function p(t){c=i[a=t],l=u.indexOf(c),s=y(),_=h()}function m(){i.forEach((function(t){v(t)||(t_form__conditionals_isStepEmpty(t)?t.classList.add("t-form__hidden-by-condition"):t.classList.contains("t-form__hidden-by-condition")&&t.classList.remove("t-form__hidden-by-condition"))})),u=i.filter((function(t){return!t.classList.contains("t-form__hidden-by-condition")})),l=u.indexOf(c),s=y(),_=h()}function v(t){return!(!e||!e.length)&&t.matches(e.join(","))}function y(){var t=Math.min(l+1,i.length-1),e=u[t];return i.indexOf(e)}function h(){var t=Math.max(l-1,0),e=u[t];return i.indexOf(e)}return m(),d.addListeners((function(){m(),o(f())})),{getState:f,onStepChange:p}}function t_form__conditionals_isStepEmpty(t){var e=t.querySelectorAll('.t-conditional:not([data-hidden-by-condition="true"])'),n=t.querySelectorAll('.t-input-group:not([data-hidden-by-condition="true"])');return 0===e.length&&0===n.length}
